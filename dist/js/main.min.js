/*! project-name v0.0.1 | (c) 2020 Francuski Miroslav | MIT License | http://link-to-your-git-repo.com */
const addCurrencyBtn=document.querySelector(".add-currency-btn"),addCurrencyList=document.querySelector(".add-currency-list"),currencyList=document.querySelector(".currencies"),apiURL="https://api.exchangeratesapi.io/latest";let baseCurrency,baseCurrencyAmount;const displayCurrencies=["EUR","USD","GBP","JPY"];let currencies=[{name:"Euro",abbreviation:"EUR",symbol:"€",flagURL:"https://upload.wikimedia.org/wikipedia/commons/b/b7/Flag_of_Europe.svg"},{name:"US Dollar",abbreviation:"USD",symbol:"$",flagURL:"http://www.geonames.org/flags/l/us.gif"},{name:"Japanese Yen",abbreviation:"JPY",symbol:"¥",flagURL:"http://www.geonames.org/flags/l/jp.gif"},{name:"British Pound",abbreviation:"GBP",symbol:"£",flagURL:"http://www.geonames.org/flags/l/uk.gif"},{name:"Australian Dollar",abbreviation:"AUD",symbol:"$",flagURL:"http://www.geonames.org/flags/l/au.gif"},{name:"Canadian Dollar",abbreviation:"CAD",symbol:"$",flagURL:"http://www.geonames.org/flags/l/ca.gif"},{name:"Swiss Franc",abbreviation:"CHF",symbol:"CHF",flagURL:"http://www.geonames.org/flags/l/ch.gif"},{name:"Chinese Yuan Renminbi",abbreviation:"CNY",symbol:"¥",flagURL:"http://www.geonames.org/flags/l/cn.gif"},{name:"Swedish Krona",abbreviation:"SEK",symbol:"kr",flagURL:"http://www.geonames.org/flags/l/se.gif"},{name:"New Zealand Dollar",abbreviation:"NZD",symbol:"$",flagURL:"http://www.geonames.org/flags/l/nz.gif"},{name:"Mexican Peso",abbreviation:"MXN",symbol:"$",flagURL:"http://www.geonames.org/flags/l/mx.gif"},{name:"Singapore Dollar",abbreviation:"SGD",symbol:"$",flagURL:"http://www.geonames.org/flags/l/sg.gif"},{name:"Hong Kong Dollar",abbreviation:"HKD",symbol:"$",flagURL:"http://www.geonames.org/flags/l/hk.gif"},{name:"Norwegian Krone",abbreviation:"NOK",symbol:"kr",flagURL:"http://www.geonames.org/flags/l/no.gif"},{name:"South Korean Won",abbreviation:"KRW",symbol:"₩",flagURL:"http://www.geonames.org/flags/l/kr.gif"},{name:"Turkish Lira",abbreviation:"TRY",symbol:"₺",flagURL:"http://www.geonames.org/flags/l/tr.gif"},{name:"Russian Ruble",abbreviation:"RUB",symbol:"₽",flagURL:"http://www.geonames.org/flags/l/ru.gif"},{name:"Indian Rupee",abbreviation:"INR",symbol:"₹",flagURL:"http://www.geonames.org/flags/l/in.gif"},{name:"Brazilian Real",abbreviation:"BRL",symbol:"R$",flagURL:"http://www.geonames.org/flags/l/br.gif"},{name:"South African Rand",abbreviation:"ZAR",symbol:"R",flagURL:"http://www.geonames.org/flags/l/za.gif"},{name:"Philippine Peso",abbreviation:"PHP",symbol:"₱",flagURL:"http://www.geonames.org/flags/l/ph.gif"},{name:"Czech Koruna",abbreviation:"CZK",symbol:"Kč",flagURL:"http://www.geonames.org/flags/l/cz.gif"},{name:"Indonesian Rupiah",abbreviation:"IDR",symbol:"Rp",flagURL:"http://www.geonames.org/flags/l/id.gif"},{name:"Malaysian Ringgit",abbreviation:"MYR",symbol:"RM",flagURL:"http://www.geonames.org/flags/l/my.gif"},{name:"Hungarian Forint",abbreviation:"HUF",symbol:"Ft",flagURL:"http://www.geonames.org/flags/l/hu.gif"},{name:"Icelandic Krona",abbreviation:"ISK",symbol:"kr",flagURL:"http://www.geonames.org/flags/l/is.gif"},{name:"Croatian Kuna",abbreviation:"HRK",symbol:"kn",flagURL:"http://www.geonames.org/flags/l/hr.gif"},{name:"Bulgarian Lev",abbreviation:"BGN",symbol:"лв",flagURL:"http://www.geonames.org/flags/l/bg.gif"},{name:"Romanian Leu",abbreviation:"RON",symbol:"lei",flagURL:"http://www.geonames.org/flags/l/ro.gif"},{name:"Danish Krone",abbreviation:"DKK",symbol:"kr",flagURL:"http://www.geonames.org/flags/l/dk.gif"},{name:"Thai Baht",abbreviation:"THB",symbol:"฿",flagURL:"http://www.geonames.org/flags/l/th.gif"},{name:"Polish Zloty",abbreviation:"PLN",symbol:"zł",flagURL:"http://www.geonames.org/flags/l/pl.gif"},{name:"Israeli Shekel",abbreviation:"ILS",symbol:"₪",flagURL:"http://www.geonames.org/flags/l/il.gif"}];function addCurrencyBtnClick(e){addCurrencyBtn.classList.toggle("open")}function addCurrencyListClick(e){const a=e.target.closest("li");if(!a.classList.contains("disabled")){const e=currencies.find(e=>e.abbreviation===a.getAttribute("data-currency"));e&&newCurrencyListItem(e)}}function currencyListClick(e){if(e.target.classList.contains("currency__close")){const a=e.target.parentNode;if(a.remove(),addCurrencyList.querySelector(`[data-currency=${a.id}]`).classList.remove("disabled"),a.classList.contains("base-currency")){const e=currencyList.querySelector(".currency");e&&(setNewBaseCurrency(e),baseCurrencyAmount=Number(e.querySelector(".currency__info--input input").value))}}}function setNewBaseCurrency(e){e.classList.add("base-currency"),baseCurrency=e.id;const a=currencies.find(e=>e.abbreviation===baseCurrency).rate;currencyList.querySelectorAll(".currency").forEach(e=>{const n=currencies.find(a=>a.abbreviation===e.id).rate,r=currencyList.id===baseCurrency?1:(n/a).toFixed(4);e.querySelector(".currency__info--base-currency-rate").textContent=`1 ${baseCurrency} = ${r} ${currencyList.id}`})}function currencyListInputChange(e){const a=e.target.closest("li").id!==baseCurrency;a&&(currencyList.querySelector(`#${baseCurrency}`).classList.remove("base-currency"),setNewBaseCurrency(e.target.closest("li")));const n=isNaN(e.target.value)?0:Number(e.target.value);if(baseCurrencyAmount!==n||a){baseCurrencyAmount=n;const e=currencies.find(e=>e.abbreviation===baseCurrency).rate;currencyList.querySelectorAll(".currency").forEach(a=>{if(a.id!==baseCurrency){const n=currencies.find(e=>e.abbreviation===a.id).rate,r=currencyList.id===baseCurrency?1:(n/e).toFixed(4);a.querySelector(".currency__info--input input").value=r*baseCurrencyAmount!=0?(r*baseCurrencyAmount).toFixed(4):""}})}}function currencyListFocusOut(e){const a=e.target.value;isNaN(a)||0===Number(a)?e.target.value="":e.target.value=Number(a).toFixed(4)}function currencyListKeydown(e){"Enter"===e.key&&e.target.blur()}function addCurrencyListHTML(){currencies.forEach(e=>{addCurrencyList.insertAdjacentHTML("beforeend",`\n  <li data-currency="${e.abbreviation}">\n    <img src="${e.flagURL}" class="flag" /><span>${e.abbreviation} - ${e.name}</span>\n  </li>\n  `)})}function displayCurrencyListHTML(){for(let e=0;e<displayCurrencies.length;e++){const a=currencies.find(a=>a.abbreviation===displayCurrencies[e]);a&&newCurrencyListItem(a)}}function newCurrencyListItem(e){0===currencyList.childElementCount&&(baseCurrency=e.abbreviation,baseCurrencyAmount=0),addCurrencyList.querySelector(`[data-currency=${e.abbreviation}]`).classList.add("disabled");const a=currencies.find(e=>e.abbreviation===baseCurrency).rate,n=e.abbreviation===baseCurrency?1:(e.rate/a).toFixed(4),r=baseCurrencyAmount?(baseCurrencyAmount*n).toFixed(4):"";currencyList.insertAdjacentHTML("beforeend",`<li class="currency ${e.abbreviation===baseCurrency?"base-currency":""}" id="${e.abbreviation}">\n          <img src="${e.flagURL}" class="currency__flag" />\n          <div class="currency__info">\n            <p class="currency__info--input">\n              <span class="currency__info--symbol">${e.symbol}</span><input type="number" placeholder="0.0000" value=${r} />\n            </p>\n            <p class="currency__info--name">${e.abbreviation} - ${e.name}</p>\n            <p class="currency__info--base-currency-rate">\n              1 ${baseCurrency} = ${n} ${e.abbreviation}\n            </p>\n          </div>\n          <span class="currency__close">&times;</span>\n      </li>`)}addCurrencyBtn.addEventListener("click",addCurrencyBtnClick),addCurrencyList.addEventListener("click",addCurrencyListClick),currencyList.addEventListener("click",currencyListClick),currencyList.addEventListener("input",currencyListInputChange),currencyList.addEventListener("focusout",currencyListFocusOut),currencyList.addEventListener("keydown",currencyListKeydown),fetch(apiURL).then(e=>e.json()).then(e=>{document.querySelector(".date").textContent=e.date.split("-").reverse().join("-"),e.rates.EUR=1,(currencies=currencies.filter(a=>e.rates[a.abbreviation])).forEach(a=>a.rate=e.rates[a.abbreviation]),addCurrencyListHTML(),displayCurrencyListHTML()}).catch(e=>console.log(e));